<header class="header">
  <div class="header-content">
    <div class="logo">BELLE VUE</div>
    <nav class="nav">
      <a routerLink="/" class="nav-item">Search Hotels</a>
      <div class="nav-item active">My Bookings</div>
      <a routerLink="/dashboard" class="nav-item">My Dashboard</a>
    </nav>
  </div>
</header>

<div class="container">
  <div class="page-header">
    <h1 class="page-title">My Bookings</h1>
  </div>

  <div class="tabs">
    <div class="tab" [class.active]="activeTab === 'all'" (click)="setTab('all')">All Bookings</div>
    <div class="tab" [class.active]="activeTab === 'upcoming'" (click)="setTab('upcoming')">Upcoming</div>
    <div class="tab" [class.active]="activeTab === 'cancelled'" (click)="setTab('cancelled')">Cancelled</div>
  </div>

  <div *ngIf="isLoading" class="loading-message">Loading bookings...</div>

  <div *ngIf="!isLoading && getFilteredBookings().length === 0" class="empty-state">
    <div class="empty-title">No Bookings Found</div>
    <div class="empty-text">You don't have any bookings in this category</div>
    <button class="empty-btn" routerLink="/">Search Hotels</button>
  </div>

  <div *ngIf="!isLoading && getFilteredBookings().length > 0">
    <div class="booking-card" *ngFor="let booking of getFilteredBookings()">
      <div class="booking-header">
        <div class="booking-id">Booking #{{ booking.id }}</div>
        <div class="booking-status" [ngClass]="getStatusClass(booking.status)">
          {{ booking.status }}
        </div>
      </div>
      <div class="booking-content">
        <div class="booking-details">
          <div class="detail-row">
            <div class="detail-label">Hotel</div>
            <div class="detail-value">Hotel ID: {{ booking.hotelId }}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">Room</div>
            <div class="detail-value">{{ booking.roomNumber }} - {{ booking.roomType }}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">Check In</div>
            <div class="detail-value">{{ formatDate(booking.checkInDate) }}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">Check Out</div>
            <div class="detail-value">{{ formatDate(booking.checkOutDate) }}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">Guests</div>
            <div class="detail-value">{{ booking.numberOfGuests }} {{ booking.numberOfGuests === 1 ? 'Guest' : 'Guests' }}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">Total Amount</div>
            <div class="detail-value">{{ formatCurrency(booking.totalAmount) }}</div>
          </div>
        </div>
        <img *ngIf="getHotelImage(booking.hotelId)" [src]="getHotelImage(booking.hotelId)" [alt]="'Hotel ' + booking.hotelId" class="booking-image">
        <div *ngIf="!getHotelImage(booking.hotelId)" class="booking-image booking-image-placeholder">Hotel Image</div>
      </div>
      <div class="booking-actions">
        <button class="action-btn">View Details</button>
        <button 
          class="action-btn btn-view-bill" 
          (click)="viewBill(booking.id)">
          View Bill
        </button>
        <button 
          class="action-btn btn-cancel" 
          *ngIf="booking.status === 'CONFIRMED' || booking.status === 'CREATED'"
          (click)="cancelBooking(booking)">
          Cancel Booking
        </button>
        <button 
          class="action-btn" 
          *ngIf="booking.status === 'CHECKED_IN' || booking.status === 'CHECKED_OUT'">
          View Invoice
        </button>
        <button 
          class="action-btn" 
          *ngIf="booking.status === 'CHECKED_OUT'">
          Leave Review
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Bill Modal -->
<div class="modal-overlay" *ngIf="showBillModal" (click)="closeBillModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Bill Details</h2>
      <button class="close-button" (click)="closeBillModal()">X</button>
    </div>
    <div class="modal-body">
      <div *ngIf="isLoadingBill" class="loading-message">Loading bill...</div>
      <div *ngIf="!isLoadingBill && selectedBill">
        <div class="bill-header">
          <div class="bill-number">Bill #{{ selectedBill.billNumber }}</div>
          <div class="bill-status" [class.pending]="selectedBill.status === 'PENDING'" [class.paid]="selectedBill.status === 'PAID'">
            {{ selectedBill.status }}
          </div>
        </div>
        <div class="bill-info">
          <div class="info-row">
            <span class="info-label">Total Amount:</span>
            <span class="info-value">{{ formatCurrency(selectedBill.totalAmount) }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Generated At:</span>
            <span class="info-value">{{ selectedBill.generatedAt | date:'medium' }}</span>
          </div>
          <div class="info-row" *ngIf="selectedBill.paidAt">
            <span class="info-label">Paid At:</span>
            <span class="info-value">{{ selectedBill.paidAt | date:'medium' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

