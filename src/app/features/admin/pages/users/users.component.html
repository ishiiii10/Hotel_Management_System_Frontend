<div class="dashboard-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">LOGO</div>
    </div>
    <nav class="sidebar-nav">
      <a routerLink="/admin/dashboard" class="nav-item">Dashboard</a>
      <a routerLink="/admin/hotels" class="nav-item">Hotels</a>
      <a routerLink="/admin/users" class="nav-item active">Users</a>
      <a routerLink="/admin/bookings" class="nav-item">Bookings</a>
      <a routerLink="/admin/reports" class="nav-item">Reports</a>
      <a routerLink="/admin/settings" class="nav-item">Settings</a>
    </nav>
    <div class="sidebar-footer">
      <button class="logout-btn-sidebar" (click)="logout()">Logout</button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="page-header">
      <h1 class="page-title">Users Management</h1>
    </header>

    <!-- Filters -->
    <section class="filters-section">
      <div class="filters-title">Search & Filter</div>
      <div class="filters-row">
        <div class="filter-group">
          <label class="filter-label">Search by Name/Username</label>
          <input type="text" class="filter-input" [(ngModel)]="searchName" placeholder="Enter name or username">
        </div>
        <div class="filter-group">
          <label class="filter-label">Email</label>
          <input type="text" class="filter-input" [(ngModel)]="searchEmail" placeholder="Enter email">
        </div>
        <div class="filter-group">
          <label class="filter-label">Role</label>
          <select class="filter-input" [(ngModel)]="searchRole">
            <option value="">All Roles</option>
            <option *ngFor="let role of roles" [value]="role">{{role}}</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Status</label>
          <select class="filter-input" [(ngModel)]="searchStatus">
            <option value="">All Status</option>
            <option *ngFor="let status of statuses" [value]="status">{{status | titlecase}}</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Hotel ID</label>
          <input type="number" class="filter-input" [(ngModel)]="searchHotelId" placeholder="Enter hotel ID">
        </div>
        <div class="filter-actions">
          <button class="btn-primary" (click)="onSearch()">Search</button>
          <button class="btn-secondary" (click)="onReset()">Reset</button>
        </div>
      </div>
    </section>

    <!-- Users Table -->
    <section class="users-section">
      <div class="section-header">All Users</div>
      <div *ngIf="isLoading" class="loading-message">Loading users...</div>
      <table class="users-table" *ngIf="!isLoading">
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Full Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Status</th>
            <th>Hotel ID</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of filteredUsers">
            <td>{{user.userId || user.id}}</td>
            <td>{{user.username}}</td>
            <td>{{user.fullName}}</td>
            <td>{{user.email}}</td>
            <td>{{user.role}}</td>
            <td>{{user.enabled ? 'Active' : 'Inactive'}}</td>
            <td>{{user.hotelId || '-'}}</td>
            <td>
              <div class="action-buttons">
                <button class="btn-action" *ngIf="user.role === 'MANAGER' || user.role === 'RECEPTIONIST'" (click)="openReassignModal(user)">Reassign</button>
                <button class="btn-action btn-danger" *ngIf="user.enabled" (click)="onDeactivateUser(user)">Deactivate</button>
              </div>
            </td>
          </tr>
          <tr *ngIf="filteredUsers.length === 0">
            <td colspan="8" class="no-data">No users found</td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>
</div>

<!-- Reassign Hotel Modal -->
<div class="modal-overlay" *ngIf="showReassignModal" (click)="closeReassignModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">Reassign Staff to Hotel</div>
    <form (ngSubmit)="onReassignHotel()">
      <div class="form-group">
        <label class="form-label">User</label>
        <input type="text" class="form-input" [value]="selectedUser?.fullName + ' (' + selectedUser?.username + ')'" disabled>
      </div>
      <div class="form-group">
        <label class="form-label">Select Hotel *</label>
        <select class="form-select" [(ngModel)]="selectedHotelId" name="hotelId" required>
          <option [value]="null">None</option>
          <option *ngFor="let hotel of hotels" [value]="hotel.id">{{hotel.name}} ({{hotel.city}})</option>
        </select>
      </div>
      <div class="form-actions">
        <button type="button" class="btn-secondary" (click)="closeReassignModal()">Cancel</button>
        <button type="submit" class="btn-primary">Reassign</button>
      </div>
    </form>
  </div>
</div>

