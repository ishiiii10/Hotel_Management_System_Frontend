<div class="dashboard-container">
  <!-- Sidebar -->
  <app-admin-sidebar></app-admin-sidebar>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="page-header">
      <h1 class="page-title">Bookings Management</h1>
    </header>

    <!-- Filters -->
    <section class="filters-section">
      <div class="filters-title">Search & Filter</div>
      <div class="filters-row">
        <div class="filter-group">
          <label class="filter-label">Booking ID</label>
          <input type="text" class="filter-input" [(ngModel)]="searchBookingId" placeholder="Enter booking ID">
        </div>
        <div class="filter-group">
          <label class="filter-label">Status</label>
          <select class="filter-input" [(ngModel)]="searchStatus">
            <option value="">All Status</option>
            <option *ngFor="let status of statuses" [value]="status">{{status}}</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Hotel ID</label>
          <input type="text" class="filter-input" [(ngModel)]="searchHotelId" placeholder="Enter hotel ID">
        </div>
        <div class="filter-actions">
          <button class="btn-primary" (click)="onSearch()">Search</button>
          <button class="btn-secondary" (click)="onReset()">Reset</button>
        </div>
      </div>
    </section>

    <!-- Bookings Table -->
    <section class="bookings-section">
      <div class="section-header">All Bookings</div>
      <div *ngIf="isLoading" class="loading-message">Loading bookings...</div>
      <table class="bookings-table" *ngIf="!isLoading">
        <thead>
          <tr>
            <th>ID</th>
            <th>User ID</th>
            <th>Hotel ID</th>
            <th>Room</th>
            <th>Check In</th>
            <th>Check Out</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let booking of filteredBookings">
            <td>{{booking.id}}</td>
            <td>{{booking.userId}}</td>
            <td>{{booking.hotelId}}</td>
            <td>{{booking.roomNumber || booking.roomId}}</td>
            <td>{{booking.checkInDate}}</td>
            <td>{{booking.checkOutDate}}</td>
            <td>{{booking.totalAmount | number:'1.2-2'}}</td>
            <td>{{booking.status}}</td>
            <td>
              <div class="action-buttons">
                <button class="btn-action" (click)="openDetailsModal(booking)">View</button>
                <button class="btn-action btn-danger" *ngIf="canCancel(booking)" (click)="openCancelModal(booking)">Cancel</button>
              </div>
            </td>
          </tr>
          <tr *ngIf="filteredBookings.length === 0">
            <td colspan="9" class="no-data">No bookings found</td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>
</div>

<!-- Booking Details Modal -->
<div class="modal-overlay" *ngIf="showDetailsModal" (click)="closeDetailsModal()">
  <div class="modal-content modal-large" (click)="$event.stopPropagation()">
    <div class="modal-header">Booking Details #{{selectedBooking?.id}}</div>
    <div class="details-content" *ngIf="selectedBooking">
      <div class="detail-row">
        <div class="detail-label">Booking ID:</div>
        <div class="detail-value">{{selectedBooking.id}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">User ID:</div>
        <div class="detail-value">{{selectedBooking.userId}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Hotel ID:</div>
        <div class="detail-value">{{selectedBooking.hotelId}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Room ID:</div>
        <div class="detail-value">{{selectedBooking.roomId}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Room Number:</div>
        <div class="detail-value">{{selectedBooking.roomNumber || '-'}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Room Type:</div>
        <div class="detail-value">{{selectedBooking.roomType || '-'}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Check In Date:</div>
        <div class="detail-value">{{selectedBooking.checkInDate}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Check Out Date:</div>
        <div class="detail-value">{{selectedBooking.checkOutDate}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Total Amount:</div>
        <div class="detail-value">{{selectedBooking.totalAmount | number:'1.2-2'}}</div>
      </div>
      <div class="detail-row">
        <div class="detail-label">Status:</div>
        <div class="detail-value">{{selectedBooking.status}}</div>
      </div>
      <div class="detail-row" *ngIf="selectedBooking.guestName">
        <div class="detail-label">Guest Name:</div>
        <div class="detail-value">{{selectedBooking.guestName}}</div>
      </div>
      <div class="detail-row" *ngIf="selectedBooking.guestEmail">
        <div class="detail-label">Guest Email:</div>
        <div class="detail-value">{{selectedBooking.guestEmail}}</div>
      </div>
      <div class="detail-row" *ngIf="selectedBooking.numberOfGuests">
        <div class="detail-label">Number of Guests:</div>
        <div class="detail-value">{{selectedBooking.numberOfGuests}}</div>
      </div>
      <div class="detail-row" *ngIf="selectedBooking.specialRequests">
        <div class="detail-label">Special Requests:</div>
        <div class="detail-value">{{selectedBooking.specialRequests}}</div>
      </div>
      <div class="detail-row" *ngIf="selectedBooking.cancellationReason">
        <div class="detail-label">Cancellation Reason:</div>
        <div class="detail-value">{{selectedBooking.cancellationReason}}</div>
      </div>
    </div>
    <div class="form-actions">
      <button type="button" class="btn-secondary" (click)="closeDetailsModal()">Close</button>
    </div>
  </div>
</div>

<!-- Cancel Booking Modal -->
<div class="modal-overlay" *ngIf="showCancelModal" (click)="closeCancelModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">Cancel Booking #{{selectedBooking?.id}}</div>
    <form (ngSubmit)="onCancelBooking()">
      <div class="form-group">
        <label class="form-label">Cancellation Reason *</label>
        <textarea class="form-textarea" [(ngModel)]="cancelReason" name="reason" required placeholder="Enter cancellation reason"></textarea>
      </div>
      <div class="form-actions">
        <button type="button" class="btn-secondary" (click)="closeCancelModal()">Cancel</button>
        <button type="submit" class="btn-primary btn-danger">Confirm Cancellation</button>
      </div>
    </form>
  </div>
</div>

