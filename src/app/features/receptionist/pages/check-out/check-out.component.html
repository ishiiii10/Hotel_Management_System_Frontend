<div class="dashboard-container">
  <app-receptionist-sidebar></app-receptionist-sidebar>

  <main class="main-content">
    <header class="page-header">
      <h1 class="page-title">Check-Out</h1>
    </header>

    <div class="filters-section">
      <div class="filters-title">Search & Filter</div>
      <div class="filters-row">
        <div class="filter-group">
          <label class="filter-label">Booking ID</label>
          <input type="number" class="filter-input" [(ngModel)]="searchBookingId" placeholder="Enter booking ID">
        </div>
        <div class="filter-group">
          <label class="filter-label">Guest Name</label>
          <input type="text" class="filter-input" [(ngModel)]="searchGuestName" placeholder="Enter guest name">
        </div>
        <div class="filter-actions">
          <button class="btn-primary" (click)="onSearch()">Search</button>
          <button class="btn-secondary" (click)="onReset()">Reset</button>
        </div>
      </div>
    </div>

    <div class="bookings-section">
      <div class="section-header">Today's Check-Outs</div>
      <div *ngIf="isLoading" class="loading-message">Loading check-outs...</div>
      <table class="bookings-table" *ngIf="!isLoading">
        <thead>
          <tr>
            <th>Booking ID</th>
            <th>Room</th>
            <th>Guest Name</th>
            <th>Guest Email</th>
            <th>Check In Date</th>
            <th>Check Out Date</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let booking of filteredCheckOuts">
            <td>{{booking.id}}</td>
            <td>{{booking.roomNumber || booking.roomId}}</td>
            <td>{{booking.guestName || '-'}}</td>
            <td>{{booking.guestEmail || '-'}}</td>
            <td>{{booking.checkInDate}}</td>
            <td>{{booking.checkOutDate}}</td>
            <td>{{formatCurrency(booking.totalAmount)}}</td>
            <td>{{booking.status}}</td>
            <td>
              <div class="action-buttons">
                <button class="btn-action" *ngIf="canCheckOut(booking)" (click)="openCheckOutModal(booking)">Check-Out</button>
                <span *ngIf="!canCheckOut(booking)" class="status-text">{{booking.status}}</span>
              </div>
            </td>
          </tr>
          <tr *ngIf="filteredCheckOuts.length === 0">
            <td colspan="9" class="no-data">No check-outs found for today</td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>
</div>

<div class="modal-overlay" *ngIf="showCheckOutModal" (click)="closeCheckOutModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Check-Out Guest</h2>
      <button class="close-button" (click)="closeCheckOutModal()">X</button>
    </div>
    <div class="modal-body" *ngIf="selectedBooking">
      <div class="booking-info">
        <div class="info-row">
          <span class="info-label">Booking ID:</span>
          <span class="info-value">{{selectedBooking.id}}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Room:</span>
          <span class="info-value">{{selectedBooking.roomNumber || selectedBooking.roomId}}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Guest:</span>
          <span class="info-value">{{selectedBooking.guestName || '-'}}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Check-In Date:</span>
          <span class="info-value">{{selectedBooking.checkInDate}}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Check-Out Date:</span>
          <span class="info-value">{{selectedBooking.checkOutDate}}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Total Amount:</span>
          <span class="info-value">{{formatCurrency(selectedBooking.totalAmount)}}</span>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Notes (Optional)</label>
        <textarea class="form-input" [(ngModel)]="checkOutNotes" rows="2" placeholder="Enter check-out notes"></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">Rating (Optional)</label>
        <input type="number" class="form-input" [(ngModel)]="checkOutRating" min="1" max="5" placeholder="1-5">
      </div>
      <div class="form-group">
        <label class="form-label">Feedback (Optional)</label>
        <textarea class="form-input" [(ngModel)]="checkOutFeedback" rows="3" placeholder="Enter feedback"></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">
          <input type="checkbox" [(ngModel)]="checkOutLate"> Late Check-out
        </label>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-secondary" (click)="closeCheckOutModal()">Cancel</button>
        <button type="button" class="btn-primary" (click)="onCheckOut()">Check-Out</button>
      </div>
    </div>
  </div>
</div>

